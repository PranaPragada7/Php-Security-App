# Apache Virtual Host Configuration for Secure Web Application
# Place this in your Apache configuration or include it in httpd.conf

# Enable SSL module (if not already enabled)
LoadModule ssl_module modules/mod_ssl.so

# Listen on port 443 for HTTPS
Listen 443

# HTTP Virtual Host (redirect to HTTPS)
<VirtualHost *:80>
    ServerName localhost
    DocumentRoot "C:/Users/prana/secure-web-project"
    
    # Redirect all HTTP traffic to HTTPS
    RewriteEngine On
    RewriteCond %{HTTPS} off
    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>

# HTTPS Virtual Host
<VirtualHost *:443>
    ServerName localhost
    DocumentRoot "C:/Users/prana/secure-web-project"
    
    # SSL Engine
    SSLEngine on
    SSLCertificateFile "C:/Users/prana/secure-web-project/ssl/server.local.crt"
    SSLCertificateKeyFile "C:/Users/prana/secure-web-project/ssl/server.local.key"
    
    # Optional: Enable client certificate authentication
    # SSLCACertificateFile "C:/Users/prana/secure-web-project/ssl/ca.crt"
    # SSLVerifyClient optional
    # SSLVerifyDepth 1
    
    # PHP configuration
    <Directory "C:/Users/prana/secure-web-project">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP handler (adjust based on your PHP installation)
        <FilesMatch \.php$>
            SetHandler application/x-httpd-php
        </FilesMatch>
    </Directory>
    
    # Directory index
    DirectoryIndex index.php index.html
    
    # Error and access logs
    ErrorLog "C:/Users/prana/secure-web-project/logs/error.log"
    CustomLog "C:/Users/prana/secure-web-project/logs/access.log" combined
    
    # Security headers
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>

# Note: Update the paths above to match your actual installation paths
# For AMPPS, the configuration might be in:
# C:\ampps\apache\conf\extra\httpd-vhosts.conf
# Or you can create a separate configuration file and include it

